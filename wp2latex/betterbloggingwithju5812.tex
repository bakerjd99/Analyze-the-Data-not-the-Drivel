%\input{bmamblenew.tex}  
    
\subsection*{\href{https://analyzethedatanotthedrivel.org/2020/06/01/better-blogging-with-jupyter-notebooks-on-wordpress-com/}{Better Blogging with Jupyter Notebooks on WordPress.com}}
\addcontentsline{toc}{subsection}{Better Blogging with Jupyter Notebooks on WordPress.com}


\noindent\emph{Posted: 02 Jun 2020 00:48:09}
\vspace{6pt}
    
    When I discovered \href{https://jupyter.org/}{Jupyter notebooks} a few
years ago I instantly recognized their potential as a \emph{technical}
blogging tool. Jupyter notebooks support mixtures of text, mathematics,
program code, and graphics in a completely interactive environment. It's
easy to convert notebook JSON \texttt{.ipynb} files to markdown,
\(\LaTeX\), and HTML so it's not a big leap to use Jupyter as a
\emph{super-editor} for blog posts with heavy doses of code,
mathematics, and graphics.

I converted a few simple notebooks into HTML and tried loading them to
my WordPress.com blog; the
\href{https://analyzethedatanotthedrivel.org/2017/12/24/downloading-smugmug-captions-with-python-and-jupyter/}{results
did not amuse me!} Raw notebook HTML is not suitable for WordPress.com.

WordPress.com imposes some serious constraints on low cost and free
blogs. You cannot:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Use arbitrary JavaScript.
\item
  Import standalone CSS styles.
\item
  Use non-standard plugins.
\end{enumerate}

By setting up your own WordPress.org site or upgrading your
WordPress.com account you can shed these limitations. I've considered
both options but there's just something about software vendors teasing
users with basic features while nagging them to spend more on upgrades
that
\href{https://www.wisegeek.com/what-does-gets-my-goat-mean.htm}{gets my
goat}. I'm used to such abuse from the likes of Adobe and would advise
WordPress.com to dial back upgrade nagging.

Fortunately, it's not necessary to upgrade your WordPress.com account to
make excellent use of Jupyter notebooks. With a few simple notebook file
hacks, you can compose in Jupyter and post to WordPress.com

    \hypertarget{hack-1-nb2wp}{%
\paragraph{Hack \#1: nb2wp}\label{hack-1-nb2wp}}

    \href{https://github.com/bennylp}{Benny Prijono} has created a handy
Python program \href{https://github.com/bennylp/nb2wp}{\texttt{nb2wp}}
that converts Jupyter notebooks to WordPress.com oriented HTML.
\texttt{nb2wp} uses
\href{https://pypi.org/project/beautifulsoup4/}{BeautifulSoup}, (a great
software name if there ever was one), and the Python utility
\href{https://pythonhosted.org/pynliner/}{pynliner} to convert the HTML
generated by the Jupyter
\href{https://anaconda.org/anaconda/nbconvert}{\texttt{nbconvert}}
utility to a WordPress.com oriented form.

\texttt{nb2wp} HTML can be pasted, (read Benny's instructions), into the
WordPress.com block editor. My post
\href{https://analyzethedatanotthedrivel.org/2020/05/25/using-jodliterate/}{Using
jodliterate} was composed in this way.

\texttt{nb2wp} notebook HTML is treated as a \emph{single} WordPress.com
block editor block. This makes it hard to use the block editor which
brings me to the next hack.

    \hypertarget{hack-2-nb2subnb}{%
\paragraph{Hack \#2: nb2subnb}\label{hack-2-nb2subnb}}

    Notebooks are stored as simple JSON files. It's easy to split notebooks
into \emph{\texttt{n}} smaller notebooks. The following Python program,
(\href{https://github.com/bakerjd99/Analyze-the-Data-not-the-Drivel/blob/master/bluts/nb2wput.py}{available
here}), cuts notebook files into smaller sub-notebooks.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{1}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{nb2subnb}\PY{p}{(}\PY{n}{filename}\PY{p}{,} \PY{o}{*}\PY{p}{,} \PY{n}{cell\PYZus{}type}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{markdown}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} 
             \PY{n}{single\PYZus{}nb}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,} \PY{n}{keep\PYZus{}cells}\PY{o}{=}\PY{p}{[}\PY{p}{]}\PY{p}{,} \PY{n}{keep\PYZus{}texts}\PY{o}{=}\PY{p}{[}\PY{p}{]}\PY{p}{)}\PY{p}{:}
    \PY{l+s+sa}{r}\PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
\PY{l+s+sd}{    (nb2subnb) splits out typed cells of jupyter }
\PY{l+s+sd}{    notebooks into n sub\PYZhy{}notebooks.}

\PY{l+s+sd}{    examples:}

\PY{l+s+sd}{       \PYZsh{} split into n markdown cell notebooks}
\PY{l+s+sd}{       nb2subnb(r\PYZsq{}C:\PYZbs{}temp\PYZbs{}UsingJodliterate.ipynb\PYZsq{})}

\PY{l+s+sd}{       \PYZsh{} split into n code cell notebooks}
\PY{l+s+sd}{       nb2subnb(r\PYZsq{}C:\PYZbs{}temp\PYZbs{}UsingJodliterate.ipynb\PYZsq{}, }
\PY{l+s+sd}{           cell\PYZus{}type=\PYZsq{}code\PYZsq{})}

\PY{l+s+sd}{       \PYZsh{} all markdown cells in single notebook}
\PY{l+s+sd}{       nb2subnb(r\PYZsq{}C:\PYZbs{}temp\PYZbs{}UsingJodliterate.ipynb\PYZsq{}, }
\PY{l+s+sd}{           single\PYZus{}nb=\PYZsq{}True\PYZsq{})}

\PY{l+s+sd}{       \PYZsh{} code cells with numbers in range as single notebook}
\PY{l+s+sd}{       nb2subnb(r\PYZsq{}C:\PYZbs{}temp\PYZbs{}UsingJodliterate.ipynb\PYZsq{}, }
\PY{l+s+sd}{           cell\PYZus{}type=\PYZsq{}code\PYZsq{}, single\PYZus{}nb=\PYZsq{}True\PYZsq{}, }
\PY{l+s+sd}{           keep\PYZus{}cells=list(range(10)))}

\PY{l+s+sd}{       \PYZsh{} markdown cells with strings \PYZsq{}Bhagavad\PYZsq{} or \PYZsq{}github\PYZsq{} }
\PY{l+s+sd}{       nb2subnb(r\PYZsq{}C:\PYZbs{}temp\PYZbs{}UsingJodliterate.ipynb\PYZsq{}, }
\PY{l+s+sd}{           single\PYZus{}nb=\PYZsq{}True\PYZsq{},}
\PY{l+s+sd}{           keep\PYZus{}texts=[\PYZsq{}Bhagavad\PYZsq{},\PYZsq{}github\PYZsq{}])}

\PY{l+s+sd}{       \PYZsh{} all code cells in range with string \PYZsq{}pacman\PYZsq{} }
\PY{l+s+sd}{       nb2subnb(r\PYZsq{}C:\PYZbs{}temp\PYZbs{}UsingJodliterate.ipynb\PYZsq{}, }
\PY{l+s+sd}{           cell\PYZus{}type=\PYZsq{}code\PYZsq{},}
\PY{l+s+sd}{           keep\PYZus{}texts=[\PYZsq{}pacman\PYZsq{}], keep\PYZus{}cells=list(range(30)))}

\PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}
    \PY{k}{with} \PY{n+nb}{open}\PY{p}{(}\PY{n}{filename}\PY{p}{)} \PY{k}{as} \PY{n}{in\PYZus{}file}\PY{p}{:}
        \PY{n}{nb\PYZus{}data} \PY{o}{=} \PY{n}{json}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{n}{in\PYZus{}file}\PY{p}{)}

    \PY{c+c1}{\PYZsh{} notebook file name without extension/path}
    \PY{n}{nbname} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{basename}\PY{p}{(}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{splitext}\PY{p}{(}\PY{n}{filename}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}

    \PY{n}{nb\PYZus{}cells}\PY{p}{,} \PY{n}{one\PYZus{}cell}\PY{p}{,} \PY{n}{nb\PYZus{}files} \PY{o}{=} \PY{n+nb}{dict}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n+nb}{list}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n+nb}{list}\PY{p}{(}\PY{p}{)}

    \PY{k}{for} \PY{n}{cnt}\PY{p}{,} \PY{n}{cell} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{nb\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cells}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{:}
        \PY{k}{if} \PY{n}{nb\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cells}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{cnt}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cell\PYZus{}type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{n}{cell\PYZus{}type}\PY{p}{:}

            \PY{k}{if} \PY{o+ow}{not} \PY{n}{single\PYZus{}nb}\PY{p}{:}
                \PY{c+c1}{\PYZsh{} single cell notebooks}
                \PY{n}{nb\PYZus{}cells}\PY{p}{,} \PY{n}{one\PYZus{}cell} \PY{o}{=} \PY{n+nb}{dict}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n+nb}{list}\PY{p}{(}\PY{p}{)}
                \PY{k}{if} \PY{l+m+mi}{0} \PY{o}{==} \PY{n+nb}{len}\PY{p}{(}\PY{n}{keep\PYZus{}cells}\PY{p}{)} \PY{o+ow}{or} \PY{n}{cnt} \PY{o+ow}{in} \PY{n}{keep\PYZus{}cells}\PY{p}{:}
                    \PY{k}{if} \PY{n}{text\PYZus{}in\PYZus{}source}\PY{p}{(}\PY{n}{cell}\PY{p}{,} \PY{n}{keep\PYZus{}texts}\PY{p}{)}\PY{p}{:}
                        \PY{n}{one\PYZus{}cell}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{cell}\PY{p}{)}
                        \PY{n}{nb\PYZus{}cells}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{cells}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{one\PYZus{}cell}
                        \PY{n}{nb\PYZus{}cells} \PY{o}{=} \PY{n}{insert\PYZus{}nb\PYZus{}metadata}\PY{p}{(}
                            \PY{n}{nb\PYZus{}data}\PY{p}{,} \PY{n}{nb\PYZus{}cells}\PY{p}{)}
                        \PY{n}{nb\PYZus{}out\PYZus{}file} \PY{o}{=} \PY{n}{NB\PYZus{}DIRECTORY} \PY{o}{+} \PYZbs{}
                            \PY{n}{nbname} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n}{cell\PYZus{}type} \PY{o}{+} \PYZbs{}
                            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{cnt}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.ipynb}\PY{l+s+s1}{\PYZsq{}}
                        \PY{n}{nb\PYZus{}files}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{nb\PYZus{}out\PYZus{}file}\PY{p}{)}
                        \PY{k}{with} \PY{n+nb}{open}\PY{p}{(}\PY{n}{nb\PYZus{}out\PYZus{}file}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{w}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{k}{as} \PY{n}{out\PYZus{}file}\PY{p}{:}
                            \PY{n}{json}\PY{o}{.}\PY{n}{dump}\PY{p}{(}\PY{n}{nb\PYZus{}cells}\PY{p}{,} \PY{n}{out\PYZus{}file}\PY{p}{,}
                                      \PY{n}{ensure\PYZus{}ascii}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
            \PY{k}{elif} \PY{n}{single\PYZus{}nb}\PY{p}{:}
                \PY{c+c1}{\PYZsh{} single notebook with only (cell\PYZus{}type) cells}
                \PY{k}{if} \PY{l+m+mi}{0} \PY{o}{==} \PY{n+nb}{len}\PY{p}{(}\PY{n}{keep\PYZus{}cells}\PY{p}{)} \PY{o+ow}{or} \PY{n}{cnt} \PY{o+ow}{in} \PY{n}{keep\PYZus{}cells}\PY{p}{:}
                    \PY{k}{if} \PY{n}{text\PYZus{}in\PYZus{}source}\PY{p}{(}\PY{n}{cell}\PY{p}{,} \PY{n}{keep\PYZus{}texts}\PY{p}{)}\PY{p}{:}
                        \PY{n}{one\PYZus{}cell}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{cell}\PY{p}{)}
                        \PY{n}{nb\PYZus{}cells}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{cells}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{one\PYZus{}cell}

    \PY{k}{if} \PY{n}{single\PYZus{}nb}\PY{p}{:}
        \PY{n}{nb\PYZus{}out\PYZus{}file} \PY{o}{=} \PY{n}{NB\PYZus{}DIRECTORY} \PY{o}{+} \PYZbs{}
            \PY{n}{nbname} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n}{cell\PYZus{}type} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}only.ipynb}\PY{l+s+s1}{\PYZsq{}}
        \PY{n}{nb\PYZus{}files}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{nb\PYZus{}out\PYZus{}file}\PY{p}{)}
        \PY{n}{nb\PYZus{}cells} \PY{o}{=} \PY{n}{insert\PYZus{}nb\PYZus{}metadata}\PY{p}{(}\PY{n}{nb\PYZus{}data}\PY{p}{,} \PY{n}{nb\PYZus{}cells}\PY{p}{)}
        \PY{k}{with} \PY{n+nb}{open}\PY{p}{(}\PY{n}{nb\PYZus{}out\PYZus{}file}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{w}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{k}{as} \PY{n}{out\PYZus{}file}\PY{p}{:}
            \PY{n}{json}\PY{o}{.}\PY{n}{dump}\PY{p}{(}\PY{n}{nb\PYZus{}cells}\PY{p}{,} \PY{n}{out\PYZus{}file}\PY{p}{,} 
                      \PY{n}{ensure\PYZus{}ascii}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}

    \PY{c+c1}{\PYZsh{} list of generated sub\PYZhy{}notebooks}
    \PY{k}{return} \PY{n}{nb\PYZus{}files}
\end{Verbatim}
\end{tcolorbox}

    \texttt{nb2wp} can be applied to the sub-notebooks to produce smaller,
more block editor friendly, HTML files. Blog posts can be put together
by picking and pasting the smaller blocks.

    \hypertarget{combining-nb2wp-and-nb2subnb}{%
\paragraph{Combining nb2wp and
nb2subnb}\label{combining-nb2wp-and-nb2subnb}}

    \texttt{nb2wpblk} combines the actions of \texttt{nb2wp} and
\texttt{nb2subnb} to generate \emph{\texttt{n}} HTML files.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{2}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} append nb2* script directory to system path}
\PY{k+kn}{import} \PY{n+nn}{sys}
\PY{n}{sys}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C:}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{temp}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{nb2wp}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{3}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} notebook file}
\PY{n}{nb\PYZus{}file} \PY{o}{=} \PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C:}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{temp}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{nb2wp}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{UsingJodliterate.ipynb}\PY{l+s+s1}{\PYZsq{}}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{4}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{nb2subnb\PYZus{}opts} \PY{o}{=} \PY{p}{\PYZob{}}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{single\PYZus{}nb}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{k+kc}{False}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cell\PYZus{}type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{keep\PYZus{}cells}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{[}\PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{8}\PY{p}{,} \PY{l+m+mi}{21}\PY{p}{]}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{keep\PYZus{}texts}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{[}\PY{p}{]}
\PY{p}{\PYZcb{}}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{5}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import} \PY{n+nn}{nb2wput} \PY{k}{as} \PY{n+nn}{nbu}

\PY{c+c1}{\PYZsh{} split notebook into selected parts and convert to HTML }
\PY{n}{nbu}\PY{o}{.}\PY{n}{nb2wpblk}\PY{p}{(}\PY{n}{nb\PYZus{}file}\PY{p}{,} \PY{n}{nb2subnb\PYZus{}parms}\PY{o}{=}\PY{n}{nb2subnb\PYZus{}opts}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Using template: full
Using CSS files ['C:\textbackslash{}\textbackslash{}temp\textbackslash{}\textbackslash{}nb2wp\textbackslash{}\textbackslash{}style.css']
Saving CSS to C:\textbackslash{}temp\textbackslash{}nb2wp\textbackslash{}tmp\textbackslash{}style.css
C:\textbackslash{}temp\textbackslash{}nb2wp\textbackslash{}tmp\textbackslash{}UsingJodliterate-code-2.html: 7054 bytes written in 4.488s
Using template: full
Using CSS files ['C:\textbackslash{}\textbackslash{}temp\textbackslash{}\textbackslash{}nb2wp\textbackslash{}\textbackslash{}style.css']
Saving CSS to C:\textbackslash{}temp\textbackslash{}nb2wp\textbackslash{}tmp\textbackslash{}style.css
C:\textbackslash{}temp\textbackslash{}nb2wp\textbackslash{}tmp\textbackslash{}UsingJodliterate-code-8.html: 4715 bytes written in 4.177s
Using template: full
Using CSS files ['C:\textbackslash{}\textbackslash{}temp\textbackslash{}\textbackslash{}nb2wp\textbackslash{}\textbackslash{}style.css']
Saving CSS to C:\textbackslash{}temp\textbackslash{}nb2wp\textbackslash{}tmp\textbackslash{}style.css
C:\textbackslash{}temp\textbackslash{}nb2wp\textbackslash{}tmp\textbackslash{}UsingJodliterate-code-21.html: 8683 bytes written in 5.437s
    \end{Verbatim}

    The utilities referenced in this post
\href{https://github.com/bakerjd99/Analyze-the-Data-not-the-Drivel/tree/master/bluts}{are
available on Github here}. Help yourself and blog better!


    % Add a bibliography block to the postdoc
    
    
    
%\end{document}
