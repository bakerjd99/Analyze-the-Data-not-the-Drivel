%\input{bmamble.tex}

\subsection*{\href{https://bakerjd99.wordpress.com/2012/02/25/wordpress-to-LaTeX-with-pandoc-and-j-using-texfrwpxml-ijs-part-3/}{WordPress to \LaTeX\ with Pandoc and J: Using \texttt{TeXfrWpxml.ijs} (3)}}
\addcontentsline{toc}{subsection}{WordPress to \LaTeX\ with Pandoc and J: Using \texttt{TeXfrWpxml.ijs} (Part 3)}


\noindent\emph{Posted: 26 Feb 2012 02:38:53}
\vspace{6pt}

%{[}caption id=``'' align=``alignright'' width=``150''  caption=``WordPress to  LaTeX''{]}
%\includegraphics{i-mNK4RHL-M.png}
%{[}/caption{]}
\captionsetup[floatingfigure]{labelformat=empty}
\begin{floatingfigure}[r]{0.23\textwidth}
\centering
\includegraphics[width=0.22\textwidth]{i-mNK4RHL-M.png}
\caption{WordPress to  \LaTeX}
\label{fig:2518X0}
\end{floatingfigure}In this post I will describe how to use the J script
\href{http://www.box.com/s/9v5b6ub9cya108c03mr7}{\texttt{TeXfrWpxml.ijs}}
to generate \LaTeX\ source from WordPress export XML. I am assuming you
have worked through
\href{http://bakerjd99.wordpress.com/2012/02/11/wordpress-to-latex-with-pandoc-and-j-prerequisites-part-1/}{(Part
1)} and
\href{http://bakerjd99.wordpress.com/2012/02/18/wordpress-to-latex-with-pandoc-and-j-latex-directories-part-2-2/}{(Part
2)} and have:

\begin{enumerate}
\item
  Successfully installed and tested
  \href{http://johnmacfarlane.net/pandoc/}{Pandoc}.
\item
  Installed and tested \href{http://www.jsoftware.com/}{a version of J}.
\item
  Set up appropriate directories
  (\href{http://bakerjd99.wordpress.com/2012/02/18/wordpress-to-latex-with-pandoc-and-j-latex-directories-part-2-2/}{Part
  2}).
\item
  Know how to use \LaTeX.
\end{enumerate}
Item \#4 is a \emph{big} if. Inexperienced \LaTeX\ users will probably not
enjoy a lot of success with this procedure as the source generated by
\texttt{TeXfrWpxml.ijs} requires manual edits to produce good results.
However, if you're not a \LaTeX\ guru, do not get discouraged. It's not
difficult to create blog documents like
\href{http://www.box.com/s/8yvm27ag9agtm32nfahd}{\texttt{bm.pdf}}.

\paragraph{Step 1: download WordPress Export XML}

How to download WordPress export XML is described
\href{http://en.blog.wordpress.com/2006/06/12/xml-import-export/}{here}.
Basically you go to your blog's dashboard, select \textbf{Tools}, choose
\textbf{Export} and select the \textbf{All content} option.


%{[}caption id=``attachment\_2521'' align=``aligncenter'' width=``260''  caption=``Tools \textgreater{} Export \textgreater{} All  Content''{]}
%\href{http://bakerjd99.files.wordpress.com/2012/02/toolsexport.png}{\includegraphics{toolsexport.png}}
%{[}/caption{]}
\captionsetup[figure]{labelformat=empty}
\begin{figure}[htbp]
\centering
\href{http://bakerjd99.files.wordpress.com/2012/02/toolsexport.png}{\includegraphics[width=0.23\textwidth]{toolsexport.png}}
\caption{Tools \textgreater{} Export \textgreater{} All  Content}
\label{fig:2518X1}
\end{figure}

When you press the \textbf{Download Export File} button your browser
will download a single XML file that contains all your posts and
comments. Remember where you save this file. I put my export XML here.
\begin{verbatim}
c:/pd/blog/wordpress/analyzethedatanotthedrivel.wordpress.xml
\end{verbatim}

\paragraph{Step 2: download \texttt{TeXfrWpxml.ijs}}

Download
\href{http://www.box.com/s/9v5b6ub9cya108c03mr7}{\texttt{TeXfrWpxml.ijs}}
and remember where you save it. I put this script here.
\begin{verbatim}
c:/pd/blog/TeXfrWpxml.ijs
\end{verbatim}

\paragraph{Step 3: start J and load \texttt{TeXfrWpxml.ijs}}

\texttt{TeXfrWpxml.ijs} was generated from
\href{http://bakerjd99.wordpress.com/the-jod-page/}{JOD dictionaries}.
With JOD it's easy to capture root word dependencies and produce
complete standalone scripts. \texttt{TeXfrWpxml.ijs} needs only the
standard J load profile to run. It does not require any libraries or
external references and should run on all Windows and Linux versions of
J after 6.02. Loading this script is a simple matter of executing:
\begin{verbatim}
load 'c:/pd/blog/TeXfrWpxml.ijs'
\end{verbatim}


The following shows this script running in a J 7.01 console. The console
is the most stripped down J runtime.
%\href{http://bakerjd99.files.wordpress.com/2012/02/wp2texjconsole.png}{\includegraphics{wp2texjconsole.png}}
\begin{figure}[htbp]
\centering
\href{http://bakerjd99.files.wordpress.com/2012/02/wp2texjconsole.png}{\includegraphics[width=\textwidth]{wp2texjconsole.png}}
\label{fig:2518X2}
\end{figure}

\paragraph{Step 4: review directories and necessary \LaTeX\ files}

The conversion script assumes proper directories are available up: see
\href{http://bakerjd99.wordpress.com/2012/02/18/wordpress-to-latex-with-pandoc-and-j-latex-directories-part-2-2/}{Part
2}. The first time you run \texttt{TeXfrWpxml.ijs} it's a good idea to
check that the directories and files the script is expecting are the
ones you want to process. You can verify the settings by displaying
\texttt{TEXFRWPDIR, TEXINCLUSIONS, TEXROOTFILE} and
\texttt{TEXPREAMBLE}.

%[sourcecode wraplines="false" gutter="false" autolinks="false"]
\begin{lstlisting}[language=jdoc,frame=single,framerule=0pt,label=lst:scr2518X0]
  TEXPREAMBLE
bmamble.tex
  TEXFRWPDIR
c:/pd/blog/wp2latex/
  TEXINCLUSIONS
inclusions
  TEXROOTFILE
bm.tex
  TEXPREAMBLE
bmamble.tex
\end{lstlisting}

If all these directories and files exist go to step (5).

\paragraph{Step 5: make sure you are online}

The first time you run the converter it will attempt to download all the
images referenced in your blog. This is where \texttt{wget.exe} gets
executed. Obviously to download anything you must be connected to the
Internet.

\paragraph{Step 6: run \texttt{LatexFrWordpress}}

Run the verb \texttt{LatexFrWordpress}. The monadic version of this verb
takes a single argument: the complete path and file name of the export
XML file you downloaded in step (1).

\footnotesize
\begin{verbatim}
xml=: 'c:/pd/blog/wordpress/analyzethedatanotthedrivel.wordpress.xml'

LatexFrWordpress xml
\end{verbatim}
\normalsize

As the verb runs you will see output like:


%[sourcecode wraplines="false" gutter="false" autolinks="false"]
% use empty language= lstlisting -- unbalanced ' chars in text
\begin{lstlisting}[language=,frame=single,framerule=0pt,label=lst:scr2518X1]
   LatexFrWordpress xml
What's In it for Facebook?
downloading: c:/pd/blog/wp2latex/inclusions/demotivational-posters-facebook-you.jpg
1 downloaded; 0 not downloaded; 0 skipped
Fake Programming
downloading: c:/pd/blog/wp2latex/inclusions/672169130_vajvn-M.png
1 downloaded; 0 not downloaded; 0 skipped
Laws or Suggestions
downloading: c:/pd/blog/wp2latex/inclusions/i-B5mfdRF-M.jpg
1 downloaded; 0 not downloaded; 0 skipped
Lens Lust

... many lines omitted ...

downloading: c:/pd/blog/wp2latex/inclusions/i-mNK4RHL-M.png
1 downloaded; 0 not downloaded; 0 skipped
WordPress to LaTeX with Pandoc and J: LaTeX Directories (Part 2)
0 downloaded; 0 not downloaded; 1 skipped
+-++
|1||
+-++
\end{lstlisting}

When the verb terminates you should have a directory
\texttt{c:/pd/blog/wp2latex} full of \texttt{*.tex} files: one file for
each blog post. Now the hard work starts.

\paragraph{Step 7: editing \LaTeX\ posts}

The conversion from WordPress XML to \LaTeX\ produces files that require
manual edits. The more images, video, tables and other elements in your
posts the more demanding these edits will become. My blog has about one
image per post. Most of these images are wrapped by text. \LaTeX\ has a
mind of its own when it comes to \emph{floating figures} and getting
illustrations to behave requires far more parameter tweaking than it
should. This is a longstanding weakness of \LaTeX\ that pretty much
everyone bitches about. My advice is start at the front of your document
and work through it post by post. The files generated by
\texttt{LatexFrWordpress} do not attempt to place figures for you but
they do bolt in ready-made figure templates as comments that you can
experiment with. Each post file is also set up for separate \LaTeX\
compilation. You don't have to compile your entire blog to tweak one
post. The one good thing about this edit step is once you have sorted
out your old posts you do not have to revisit them unless you make major
global document changes. The next time you run \texttt{LatexFrWordpress}
it will only bring down new posts and images.

\paragraph{Step 8: compile your \LaTeX\ blog}

I use batch files and shell scripts to drive \LaTeX\ compilations. I
processed my blog with this batch file.

%[sourcecode wraplines="false" gutter="false" autolinks="false"]
\begin{lstlisting}[language=bat,frame=single,framerule=0pt,label=lst:scr2518X2]
echo off
rem process blog posting (bm.tex) root file
title Running Blog Master/LaTeX ...

rem first pass for aux file needed by bibtex
lualatex bm

rem generate/reset bbl file
bibtex bm
makeindex bm

rem resolve all internal references - may
rem comment out when debugging entire document
lualatex bm
lualatex bm

rem display pdf - point to prefered PDF reader
title Blog Master/LaTeX complete displaying PDF ...
"C:\Program Files\SumatraPDF\SumatraPDF.exe" bm.pdf
\end{lstlisting}

The presence of Unicode APL, see
\href{http://bakerjd99.wordpress.com/2010/11/12/the-return-of-apl-fingers-2/}{this
post}, forced me to use lua\LaTeX. I needed some very
nonstandard APL fonts. \textbf{See
\href{http://www.box.com/s/8yvm27ag9agtm32nfahd}{bm.pdf} --- also
available on the \href{http://bakerjd99.wordpress.com/download-this-blog/}{\emph{Download this Blog}} page ---} to judge the
effectiveness of my edits. Producing nice figure laden typeset blog
documents is work but, as I will describe in the next post,
\emph{producing image free eBooks is a simple and far less laborious
variation on this process}.

%\captionsetup[floatingfigure]{labelformat=empty}
%\begin{figure}[htbp]
%\begin{floatingfigure}[l]{0.25\textwidth}
%\centering
%\includegraphics[width=0.23\textwidth]{i-mNK4RHL-M.png}
%\caption{~~~IMCAPTION~~~}
%\label{fig:2518X0}
%\end{floatingfigure}
%\end{figure}

%\captionsetup[floatingfigure]{labelformat=empty}
%\begin{figure}[htbp]
%\begin{floatingfigure}[l]{0.25\textwidth}
%\centering
%\includegraphics[width=0.23\textwidth]{toolsexport.png}
%\caption{~~~IMCAPTION~~~}
%\label{fig:2518X1}
%\end{floatingfigure}
%\end{figure}

%\captionsetup[floatingfigure]{labelformat=empty}
%\begin{figure}[htbp]
%\begin{floatingfigure}[l]{0.25\textwidth}
%\centering
%\includegraphics[width=0.23\textwidth]{wp2texjconsole.png}
%\caption{~~~IMCAPTION~~~}
%\label{fig:2518X2}
%\end{floatingfigure}
%\end{figure}


%\end{document}